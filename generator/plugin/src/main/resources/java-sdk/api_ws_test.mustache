package {{package}};
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.kucoin.universal.sdk.model.WsMessage;
import java.util.ArrayList;
import java.util.List;

class {{classname}}AutoGeneratedTest{
    public static ObjectMapper mapper = new ObjectMapper();

    private static final List<String> failedTests = new ArrayList<>();

{{#operations}}
    {{#operation}}
    /**
    * {{vendorExtensions.x-meta.method}}
    * {{summary}}
    * {{path}}
    */
    public static void test{{vendorExtensions.x-meta.methodServiceFmt}}Response() throws Exception {
        String data = "{{{vendorExtensions.x-response-example}}}";
        WsMessage<{{vendorExtensions.x-meta.methodServiceFmt}}Event> resp = mapper.readValue(data, new TypeReference<WsMessage<{{vendorExtensions.x-meta.methodServiceFmt}}Event>>(){});
    }
    {{/operation}}
{{/operations}}

    public static void runAllTests() {
{{#operations}}
    {{#operation}}
        run({{classname}}AutoGeneratedTest::test{{vendorExtensions.x-meta.methodServiceFmt}}Response, "test{{vendorExtensions.x-meta.methodServiceFmt}}Response");
    {{/operation}}
{{/operations}}
    }

    private static void run(TestCase test, String name) {
       System.out.println("Running test: " + name);
       try {
           test.execute();
           System.out.println("PASSED: " + name);
       } catch (Exception e) {
           System.err.println("FAILED: " + name + " - " + e.getMessage());
           e.printStackTrace(System.err);
           failedTests.add(name);
       }
    }

    @FunctionalInterface
    interface TestCase {
        void execute() throws Exception;
    }

    public static void main(String[] args) {
        runAllTests();
        finish();
    }

    public static void finish() {
        if (!failedTests.isEmpty()) {
            System.err.println("\n=== TEST SUMMARY ===");
            System.err.println("Failed tests:");
            for (String name : failedTests) {
                System.err.println(" - " + name);
            }
            System.exit(1);
        } else {
            System.out.println("\nAll tests passed.");
        }
    }
}